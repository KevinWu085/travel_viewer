<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 Jan London/Spain/Lisbon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bg: '#FDFCFB',
                        surface: '#FFFFFF',
                        primary: 'var(--primary-color, #BC5D37)',
                        secondary: '#4A5568',
                        accent: '#E2B08E',
                        text: '#1A202C',
                    },
                    fontFamily: {
                        sans: ['DM Sans', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>

    <style>
        :root {
            --primary-color: #7EA2D6; /* Updated lighter London default */
        }

        body { 
            background-color: #FDFCFB; 
            color: #1A202C;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
            transition: background-color 0.5s ease;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .active-nav { color: var(--primary-color); }
        .active-nav div { transform: scale(1.1); }

        .fade-in { animation: fadeIn 0.4s ease-out; }
        .slide-up { animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1); }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .date-pill-active {
            background-color: var(--primary-color) !important;
            color: white !important;
            border-color: var(--primary-color) !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234A5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1em;
        }

        .theme-transition {
            transition: color 0.5s ease, background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen pb-24">

    <!-- Mobile App Bar -->
    <header class="bg-surface/80 backdrop-blur-md sticky top-0 z-40 border-b border-gray-200">
        <div class="max-w-md mx-auto px-5 py-4 flex justify-between items-center">
            <div>
                <p id="ui-tour-label" class="text-[10px] font-bold uppercase tracking-widest text-primary theme-transition">2026 Jan London/Spain/Lisbon</p>
                <h1 id="app-header-title" class="font-serif text-xl font-bold">The Journey</h1>
            </div>
            <button onclick="toggleLang()" class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center border border-primary/20 theme-transition text-primary font-bold text-xs select-none">
                <span id="lang-btn-text">ç¹</span>
            </button>
        </div>
        
        <!-- Horizontal Date Selector -->
        <div id="date-scroll-container" class="max-w-md mx-auto px-5 py-3 overflow-x-auto no-scrollbar flex space-x-3">
            <!-- Populated via JS -->
        </div>
    </header>

    <!-- App View Container -->
    <main class="max-w-md mx-auto w-full px-5 py-6">

        <!-- City Banner (Solid Background) -->
        <div id="city-banner" class="mb-6 fade-in">
            <div class="bg-primary rounded-3xl p-6 relative overflow-hidden theme-transition shadow-lg">
                <div class="flex items-center space-x-4 relative z-10">
                    <div class="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center text-2xl theme-transition">ğŸ“</div>
                    <div>
                        <p id="ui-location-label" class="text-[10px] font-bold uppercase tracking-widest text-white/80 leading-none mb-1 theme-transition">Location</p>
                        <h2 id="current-city-name" class="font-bold text-white text-2xl leading-none theme-transition">London</h2>
                    </div>
                </div>
                <!-- Decorative background blob -->
                <div class="absolute -right-4 -top-4 w-32 h-32 bg-white/10 rounded-full blur-3xl theme-transition"></div>
            </div>
        </div>

        <!-- VIEW: TIMELINE (The Journey) -->
        <section id="view-timeline" class="slide-up space-y-5 cursor-grab active:cursor-grabbing select-none touch-pan-y">
            <div id="day-content-container" class="space-y-4">
                <!-- Event cards injected here -->
            </div>
        </section>

        <!-- VIEW: CATEGORY -->
        <section id="view-category" class="hidden fade-in space-y-6">
            <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-300">
                <h2 id="ui-category-view-title" class="font-serif text-2xl font-bold mb-3">Category View</h2>
                <p id="ui-category-desc" class="text-secondary text-xs leading-relaxed mb-5">Browse specific types of reservations and activities across the full trip.</p>
                
                <div class="relative">
                    <label id="ui-filter-label" class="text-[10px] font-bold uppercase text-primary tracking-widest block mb-2 px-1 theme-transition">Filter By</label>
                    <select id="category-select" onchange="renderCategory(this.value)" class="w-full bg-bg border border-gray-300 rounded-xl px-4 py-3 text-sm font-bold text-text focus:outline-none focus:ring-2 focus:ring-primary/20 transition-all theme-transition">
                        <!-- Options populated via JS for language support -->
                    </select>
                </div>
            </div>

            <div id="category-results" class="space-y-4">
                <!-- Category results injected here -->
            </div>
        </section>

        <!-- VIEW: MEMOS -->
        <section id="view-memos" class="hidden fade-in space-y-6">
            <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-300">
                <h2 id="ui-memos-title" class="font-serif text-2xl font-bold mb-2">Group Memos</h2>
                <p id="ui-memos-desc" class="text-secondary text-xs mb-6">Shared space for notes and group reminders.</p>
                
                <div class="bg-bg border border-gray-300 rounded-2xl p-5 mb-4">
                    <div class="flex items-center space-x-4 mb-4">
                        <div class="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center text-lg">ğŸ“„</div>
                        <div class="flex-grow">
                            <h4 id="ui-gdoc-title" class="font-bold text-sm">Shared Google Doc</h4>
                            <p id="ui-gdoc-sub" class="text-[10px] text-secondary">Real-time collaborative notes</p>
                        </div>
                        <a id="ui-gdoc-btn" href="https://docs.google.com/document/u/0/" target="_blank" class="bg-primary text-white text-[10px] font-bold px-4 py-2 rounded-lg shadow-md active:scale-95 transition-all uppercase theme-transition">Open</a>
                    </div>
                </div>

                <div class="space-y-3">
                    <h4 id="ui-reminders-label" class="text-[10px] font-bold uppercase tracking-widest text-primary px-1 theme-transition">ğŸ“Œ Reminders</h4>
                    <div id="ui-reminders-list" class="bg-surface border border-gray-300 rounded-2xl p-4 shadow-sm">
                        <!-- Reminders populated via JS for language support -->
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Bottom Navigation Bar -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-xl border-t border-gray-200 z-50">
        <div class="max-w-md mx-auto flex justify-around items-center px-4 py-3">
            <button onclick="switchTab('timeline')" id="nav-timeline" class="flex flex-col items-center space-y-1 active-nav transition-all theme-transition">
                <div class="text-2xl">ğŸ—“ï¸</div>
                <span id="ui-nav-journey" class="text-[10px] font-bold uppercase tracking-tighter">Journey</span>
            </button>
            <button onclick="switchTab('category')" id="nav-category" class="flex flex-col items-center space-y-1 text-gray-400 transition-all theme-transition">
                <div class="text-2xl">ğŸ“‚</div>
                <span id="ui-nav-category" class="text-[10px] font-bold uppercase tracking-tighter">Category</span>
            </button>
            <button onclick="switchTab('memos')" id="nav-memos" class="flex flex-col items-center space-y-1 text-gray-400 transition-all theme-transition">
                <div class="text-2xl">âœï¸</div>
                <span id="ui-nav-memos" class="text-[10px] font-bold uppercase tracking-tighter">Memos</span>
            </button>
        </div>
    </nav>

    <script>
        const translations = {
            en: {
                tourLabel: "2026 Jan London/Spain/Lisbon",
                journey: "The Journey",
                category: "Category",
                memos: "Memos",
                location: "Location",
                categoryView: "Category View",
                categoryDesc: "Browse specific types of reservations and activities across the full trip.",
                filterBy: "Filter By",
                memosDesc: "Shared space for notes and group reminders.",
                gdocTitle: "Shared Google Doc",
                gdocSub: "Real-time collaborative notes",
                open: "Open",
                reminders: "ğŸ“Œ Reminders",
                remindersContent: `
                    <ul class="space-y-3">
                        <li class="flex items-start space-x-3">
                            <span class="text-xs">ğŸ‘</span>
                            <p class="text-[11px] text-secondary leading-normal"><strong>Dress Code:</strong> Fumo London and Prado are smart-casual.</p>
                        </li>
                        <li class="flex items-start space-x-3">
                            <span class="text-xs">ğŸ”‹</span>
                            <p class="text-[11px] text-secondary leading-normal"><strong>Power:</strong> UK vs EU adapters required.</p>
                        </li>
                    </ul>
                `,
                catFlights: "âœˆï¸ Flights",
                catHotels: "ğŸ¨ Hotels",
                catMeals: "ğŸ½ï¸ Meals",
                catTours: "ğŸ¨ Tours",
                langToggle: "ç¹",
                map: "Map"
            },
            zh: {
                tourLabel: "2026 ä¸€æœˆ å€«æ•¦/è¥¿ç­ç‰™/é‡Œæ–¯æœ¬",
                journey: "è¡Œç¨‹å…§å®¹",
                category: "é¡åˆ¥ç€è¦½",
                memos: "å‚™å¿˜éŒ„",
                location: "ç•¶å‰åœ°é»",
                categoryView: "åˆ†é¡æª¢è¦–",
                categoryDesc: "ç€è¦½æ•´å€‹è¡Œç¨‹ä¸­ç‰¹å®šé¡åˆ¥çš„é è¨‚å’Œæ´»å‹•ã€‚",
                filterBy: "éæ¿¾æ¢ä»¶",
                memosDesc: "åˆ†äº«ç­†è¨˜ã€é–‹æ”¯åŠåœ˜éšŠæé†’çš„ç©ºé–“ã€‚",
                gdocTitle: "å…±äº« Google æ–‡æª”",
                gdocSub: "å³æ™‚å”ä½œç­†è¨˜",
                open: "é–‹å•Ÿ",
                reminders: "ğŸ“Œ é‡è¦æé†’",
                remindersContent: `
                    <ul class="space-y-3">
                        <li class="flex items-start space-x-3">
                            <span class="text-xs">ğŸ‘</span>
                            <p class="text-[11px] text-secondary leading-normal"><strong>æœè£è¦æ±‚ï¼š</strong> Fumo London å’Œ Prado ç‚ºå•†å‹™ä¼‘é–’è£ã€‚</p>
                        </li>
                        <li class="flex items-start space-x-3">
                            <span class="text-xs">ğŸ”‹</span>
                            <p class="text-[11px] text-secondary leading-normal"><strong>é›»æºï¼š</strong> å€«æ•¦éœ€è‹±åœ‹è½‰æ¥é ­ï¼Œè¥¿ç­ç‰™/è‘¡è„ç‰™éœ€æ­æ¨™è½‰æ¥é ­ã€‚</p>
                        </li>
                    </ul>
                `,
                catFlights: "âœˆï¸ èˆªç­",
                catHotels: "ğŸ¨ é…’åº—",
                catMeals: "ğŸ½ï¸ é¤é£²",
                catTours: "ğŸ¨ å°è¦½",
                langToggle: "EN",
                map: "åœ°åœ–"
            }
        };

        const tripData = [
            { date: "2025-12-29", display: "29 Dec", day: "Mon", dayZh: "ä¸€", city: "Transit", cityZh: "è½‰æ©Ÿ", events: [{ type: "flight", title: "SFO â” LHR", titleZh: "èˆŠé‡‘å±± â” å€«æ•¦", time: "12:50 PM", details: "United UA 901", sub: "Seats: 12A, 12B, 12D, 12E" }, { type: "hotel", title: "Heathrow Marriott", titleZh: "å¸Œæ€ç¾…è¬æ€¡é…’åº—", time: "Arr", details: "Morning Refresh Stay", sub: "", mapUrl: "https://www.google.com/maps/search/?api=1&query=London+Heathrow+Marriott+Hotel" }] },
            { date: "2025-12-30", display: "30 Dec", day: "Tue", dayZh: "äºŒ", city: "London", cityZh: "å€«æ•¦", events: [{ type: "transfer", title: "Arrival", titleZh: "æŠµé”", time: "07:25 AM", details: "Customs & Luggage", sub: "" }, { type: "hotel", title: "W London", titleZh: "W é…’åº—", time: "Check-in", details: "Leicester Square", sub: "", mapUrl: "https://www.google.com/maps/search/?api=1&query=W+London+Leicester+Square" }, { type: "dining", title: "The Eight", titleZh: "The Eight é¤å»³", time: "Evening", details: "Maybe (Tentative)", sub: "", mapUrl: "https://www.google.com/maps/search/?api=1&query=The+Eight+Restaurant+London" }] },
            { date: "2025-12-31", display: "31 Dec", day: "Wed", dayZh: "ä¸‰", city: "London", cityZh: "å€«æ•¦", events: [{ type: "dining", title: "Dishoom Carnaby", titleZh: "Dishoom å°åº¦é¤", time: "12:30 PM", details: "Bombay Cafe Lunch", sub: "Confirmed", mapUrl: "https://www.google.com/maps/search/?api=1&query=Dishoom+Carnaby+London" }, { type: "dining", title: "Fumo London", titleZh: "Fumo ç¾©å¤§åˆ©é¤", time: "08:00 PM", details: "NYE Dinner", sub: "Confirmed", mapUrl: "https://www.google.com/maps/search/?api=1&query=Fumo+London" }] },
            { date: "2026-01-01", display: "01 Jan", day: "Thu", dayZh: "å››", city: "London", cityZh: "å€«æ•¦", events: [{ type: "activity", title: "Aqua Shard", titleZh: "ç¢ç‰‡å¤§å»ˆä¸‹åˆèŒ¶", time: "03:30 PM", details: "Afternoon Tea", sub: "Level 31 Views", mapUrl: "https://www.google.com/maps/search/?api=1&query=Aqua+Shard+London" }] },
            { date: "2026-01-02", display: "02 Jan", day: "Fri", dayZh: "äº”", city: "Granada", cityZh: "æ ¼æ‹‰ç´é”", events: [{ type: "flight", title: "LHR â” AGP", titleZh: "å€«æ•¦ â” é¦¬æ‹‰åŠ ", time: "02:55 PM", details: "BA 424", sub: "Seats: 3A, 3C, 4A, 4C" }, { type: "transfer", title: "Private Van", titleZh: "ç§äººæ¥é€", time: "06:55 PM", details: "To Seda Club", sub: "" }, { type: "hotel", title: "Seda Club Hotel", titleZh: "Seda Club é…’åº—", time: "Check-in", details: "Granada", sub: "", mapUrl: "https://www.google.com/maps/search/?api=1&query=Seda+Club+Hotel+Granada" }] },
            { date: "2026-01-03", display: "03 Jan", day: "Sat", dayZh: "å…­", city: "Granada", cityZh: "æ ¼æ‹‰ç´é”", events: [{ type: "activity", title: "Sultan's Secrets", titleZh: "è˜‡ä¸¹çš„ç§˜å¯†", time: "10:00 AM", details: "Alhambra Tour", sub: "Private Guide", mapUrl: "https://www.google.com/maps/search/?api=1&query=Alhambra+Granada" }, { type: "dining", title: "Flavors of Granada", titleZh: "æ ¼æ‹‰ç´é”é¢¨å‘³", time: "07:30 PM", details: "Dinner Experience", sub: "Confirmed", mapUrl: "https://www.google.com/maps/search/?api=1&query=Granada+City+Center" }] },
            { date: "2026-01-04", display: "04 Jan", day: "Sun", dayZh: "æ—¥", city: "Sevilla", cityZh: "å¡ç¶­åˆ©äº", events: [{ type: "transfer", title: "To Sevilla", titleZh: "å‰å¾€å¡ç¶­åˆ©äº", time: "12:00 PM", details: "via Antequera", sub: "" }, { type: "dining", title: "Arte de Cozina", titleZh: "Arte de Cozina åˆé¤", time: "01:30 PM", details: "Antequera Stop", sub: "Historic Stop", mapUrl: "https://www.google.com/maps/search/?api=1&query=Arte+de+Cozina+Antequera" }, { type: "hotel", title: "Mercer Sevilla", titleZh: "ç¾å±…å¡ç¶­åˆ©äº", time: "Check-in", details: "2 Junior Suites", sub: "", mapUrl: "https://www.google.com/maps/search/?api=1&query=Mercer+Sevilla" }] },
            { date: "2026-01-05", display: "05 Jan", day: "Mon", dayZh: "ä¸€", city: "Sevilla", cityZh: "å¡ç¶­åˆ©äº", events: [{ type: "activity", title: "Timeless Sevilla", titleZh: "æ°¸æ†å¡ç¶­åˆ©äº", time: "10:00 AM", details: "Cathedral & AlcÃ¡zar", sub: "Private", mapUrl: "https://www.google.com/maps/search/?api=1&query=Royal+AlcÃ¡zar+of+Seville" }, { type: "dining", title: "Tradevo Centro", titleZh: "Tradevo æ™šé¤", time: "08:30 PM", details: "Dinner Reservation", sub: "Confirmed", mapUrl: "https://www.google.com/maps/search/?api=1&query=Tradevo+Centro+Sevilla" }] },
            { date: "2026-01-06", display: "06 Jan", day: "Tue", dayZh: "äºŒ", city: "Sevilla", cityZh: "å¡ç¶­åˆ©äº", events: [{ type: "activity", title: "GastrorfebrerÃ­a", titleZh: "ç¾é£Ÿèˆ‡å·¥è—é«”é©—", time: "10:00 AM", details: "Metal Craft & Oil", sub: "Includes Lunch", mapUrl: "https://www.google.com/maps/search/?api=1&query=Seville+City+Center" }, { type: "dining", title: "El PintÃ³n", titleZh: "El PintÃ³n æ™šé¤", time: "07:00 PM", details: "Modern Courtyard", sub: "Confirmed", mapUrl: "https://www.google.com/maps/search/?api=1&query=El+Pinton+Sevilla" }] },
            { date: "2026-01-07", display: "07 Jan", day: "Wed", dayZh: "ä¸‰", city: "Lisbon", cityZh: "é‡Œæ–¯æœ¬", events: [{ type: "dining", title: "Farewell Lunch", titleZh: "å‘Šåˆ¥åˆé¤", time: "Lunch", details: "Seville Placeholder", sub: "" }, { type: "flight", title: "SVQ â” LIS", titleZh: "å¡ç¶­åˆ©äº â” é‡Œæ–¯æœ¬", time: "04:00 PM", details: "TAP TP 1105", sub: "Seats: 2A, 2C, 2D, 2F" }, { type: "hotel", title: "The Verse", titleZh: "The Verse é…’åº—", time: "Check-in", details: "Lisbon", sub: "", mapUrl: "https://www.google.com/maps/search/?api=1&query=The+Verse+Lisbon" }, { type: "dining", title: "Time Out Market", titleZh: "Time Out å¸‚é›†", time: "08:00 PM", details: "Casual Dinner", sub: "Confirmed", mapUrl: "https://www.google.com/maps/search/?api=1&query=Time+Out+Market+Lisbon" }] },
            { date: "2026-01-08", display: "08 Jan", day: "Thu", dayZh: "å››", city: "Lisbon", cityZh: "é‡Œæ–¯æœ¬", events: [{ type: "activity", title: "Panoramic Tour", titleZh: "é‡Œæ–¯æœ¬å…¨æ™¯å°è¦½", time: "01:00 PM", details: "BelÃ©m & Tiles", sub: "Includes Workshop", mapUrl: "https://www.google.com/maps/search/?api=1&query=BelÃ©m+Tower+Lisbon" }, { type: "dining", title: "Cervejaria Ramiro", titleZh: "Ramiro æµ·é®®é¤", time: "08:30 PM", details: "Seafood Dinner", sub: "Confirmed", mapUrl: "https://www.google.com/maps/search/?api=1&query=Cervejaria+Ramiro+Lisbon" }] },
            { date: "2026-01-09", display: "09 Jan", day: "Fri", dayZh: "äº”", city: "Lisbon", cityZh: "é‡Œæ–¯æœ¬", events: [{ type: "activity", title: "Cooking Class", titleZh: "ç§äººçƒ¹é£ªèª²ç¨‹", time: "10:30 AM", details: "Market & Chef", sub: "Market Tour", mapUrl: "https://www.google.com/maps/search/?api=1&query=Mercado+da+Ribeira+Lisbon" }, { type: "dining", title: "PRADO", titleZh: "PRADO æ™šé¤", time: "07:00 PM", details: "Dinner Reservation", sub: "Confirmed", mapUrl: "https://www.google.com/maps/search/?api=1&query=PRADO+Restaurante+Lisbon" }] },
            { date: "2026-01-10", display: "10 Jan", day: "Sat", dayZh: "å…­", city: "Departure", cityZh: "å›ç¨‹", events: [{ type: "flight", title: "LIS â” SFO", titleZh: "é‡Œæ–¯æœ¬ â” èˆŠé‡‘å±±", time: "10:15 AM", details: "United UA 65", sub: "Polaris Business" }] }
        ];

        const themes = {
            "London": "#7EA2D6",    // Brighter Sky Navy
            "Granada": "#BC5D37",   // Terracotta
            "Sevilla": "#D49B00",   // Gold
            "Lisbon": "#007B7F",    // Teal
            "Transit": "#4A5568",   // Slate
            "Departure": "#2D3748"  // Charcoal
        };

        let currentDayIndex = 0;
        let currentLang = 'en';
        let currentTab = 'timeline';
        let touchStartX, touchStartY, touchEndX, touchEndY;

        const icons = { flight: "âœˆï¸", hotel: "ğŸ¨", dining: "ğŸ½ï¸", activity: "ğŸ¨", transfer: "ğŸš™" };
        const colors = { flight: "text-blue-600 bg-blue-50", hotel: "text-purple-600 bg-purple-50", dining: "text-orange-600 bg-orange-50", activity: "text-emerald-600 bg-emerald-50", transfer: "text-slate-600 bg-slate-50" };

        function updateTheme(city) {
            const color = themes[city] || themes["Transit"];
            document.documentElement.style.setProperty('--primary-color', color);
        }

        function toggleLang() {
            currentLang = currentLang === 'en' ? 'zh' : 'en';
            updateUIStrings();
            renderDateSelector();
            if (currentTab === 'category') renderCategory(document.getElementById('category-select').value);
        }

        function updateUIStrings() {
            const t = translations[currentLang];
            document.getElementById('ui-tour-label').innerText = t.tourLabel;
            document.getElementById('ui-location-label').innerText = t.location;
            document.getElementById('ui-category-view-title').innerText = t.categoryView;
            document.getElementById('ui-category-desc').innerText = t.categoryDesc;
            document.getElementById('ui-filter-label').innerText = t.filterBy;
            document.getElementById('ui-memos-title').innerText = t.memos;
            document.getElementById('ui-memos-desc').innerText = t.memosDesc;
            document.getElementById('ui-gdoc-title').innerText = t.gdocTitle;
            document.getElementById('ui-gdoc-sub').innerText = t.gdocSub;
            document.getElementById('ui-gdoc-btn').innerText = t.open;
            document.getElementById('ui-reminders-label').innerText = t.reminders;
            document.getElementById('ui-reminders-list').innerHTML = t.remindersContent;
            document.getElementById('ui-nav-journey').innerText = t.journey;
            document.getElementById('ui-nav-category').innerText = t.category;
            document.getElementById('ui-nav-memos').innerText = t.memos;
            document.getElementById('lang-btn-text').innerText = t.langToggle;

            const headerTitle = document.getElementById('app-header-title');
            if (currentTab === 'timeline') headerTitle.innerText = t.journey;
            else if (currentTab === 'category') headerTitle.innerText = t.category;
            else headerTitle.innerText = t.memos;

            const sel = document.getElementById('category-select');
            const currentVal = sel.value || 'flight';
            sel.innerHTML = `
                <option value="flight">${t.catFlights}</option>
                <option value="hotel">${t.catHotels}</option>
                <option value="dining">${t.catMeals}</option>
                <option value="activity">${t.catTours}</option>
            `;
            sel.value = currentVal;
        }

        function renderDateSelector() {
            const container = document.getElementById('date-scroll-container');
            container.innerHTML = tripData.map((d, i) => `
                <button onclick="showDay(${i})" id="date-pill-${i}" 
                    class="date-pill flex-shrink-0 px-4 py-2 rounded-2xl border border-gray-300 bg-white text-center transition-all theme-transition">
                    <div class="date-subtext text-[10px] font-bold uppercase text-secondary opacity-60">${currentLang === 'en' ? d.day : d.dayZh}</div>
                    <div class="date-maintext text-sm font-bold text-text">${d.display}</div>
                </button>
            `).join('');
            showDay(currentDayIndex);
        }

        function generateEventCard(e) {
            const t = translations[currentLang];
            const mapButton = e.mapUrl ? `
                <a href="${e.mapUrl}" target="_blank" class="mt-3 inline-flex items-center space-x-1 py-1 px-3 bg-primary/10 rounded-md border border-primary/30 text-primary theme-transition active:scale-95 transition-all">
                    <span class="text-[10px] font-bold uppercase tracking-widest">${t.map}</span>
                    <span class="text-[10px]">ğŸ“</span>
                </a>
            ` : '';

            return `
                <div class="bg-white p-5 rounded-3xl border border-gray-300 shadow-sm flex space-x-4 items-start active:scale-95 transition-transform slide-up">
                    <div class="w-12 h-12 rounded-2xl ${colors[e.type] || 'bg-gray-50'} flex items-center justify-center text-xl flex-shrink-0">
                        ${icons[e.type] || 'ğŸ“'}
                    </div>
                    <div class="flex-grow">
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-[10px] font-bold uppercase tracking-widest text-secondary opacity-50">${e.type}</span>
                            <span class="text-xs font-bold text-primary theme-transition">${e.time}</span>
                        </div>
                        <h3 class="font-bold text-lg leading-tight">${currentLang === 'en' ? e.title : e.titleZh}</h3>
                        <p class="text-xs text-secondary mt-1">${e.details}</p>
                        <div class="flex flex-wrap items-center gap-2">
                            ${e.sub ? `<div class="mt-3 text-[10px] py-1 px-2 bg-gray-50 inline-block rounded-md border border-gray-300 font-bold text-secondary uppercase">${e.sub}</div>` : ''}
                            ${mapButton}
                        </div>
                    </div>
                </div>
            `;
        }

        function showDay(idx) {
            currentDayIndex = idx;
            document.querySelectorAll('.date-pill').forEach(p => p.classList.remove('date-pill-active'));
            const activeBtn = document.getElementById(`date-pill-${idx}`);
            if (activeBtn) {
                activeBtn.classList.add('date-pill-active');
                activeBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }
            
            const day = tripData[idx];
            updateTheme(day.city);
            document.getElementById('current-city-name').innerText = currentLang === 'en' ? day.city : day.cityZh;
            
            const container = document.getElementById('day-content-container');
            container.innerHTML = day.events.map((e, i) => generateEventCard(e)).join('');
        }

        function switchTab(tabId) {
            currentTab = tabId;
            const sections = ['timeline', 'category', 'memos'];
            sections.forEach(id => {
                document.getElementById(`view-${id}`).classList.toggle('hidden', id !== tabId);
                document.getElementById(`nav-${id}`).classList.toggle('active-nav', id === tabId);
                document.getElementById(`nav-${id}`).classList.toggle('text-gray-400', id !== tabId);
            });
            
            const header = document.getElementById('app-header-title');
            const scroller = document.getElementById('date-scroll-container');
            const banner = document.getElementById('city-banner');
            const t = translations[currentLang];
            
            if (tabId === 'timeline') { 
                header.innerText = t.journey; 
                scroller.classList.remove('hidden'); 
                banner.classList.remove('hidden');
                updateTheme(tripData[currentDayIndex].city);
            } else {
                scroller.classList.add('hidden');
                banner.classList.add('hidden');
                updateTheme("Transit");
                if (tabId === 'category') {
                    header.innerText = t.category;
                    renderCategory(document.getElementById('category-select').value);
                }
                if (tabId === 'memos') header.innerText = t.memos;
            }
        }

        function renderCategory(category) {
            const container = document.getElementById('category-results');
            const items = [];
            tripData.forEach(day => {
                day.events.forEach(e => {
                    if (e.type === category) {
                        const t = translations[currentLang];
                        const mapBtn = e.mapUrl ? `
                            <a href="${e.mapUrl}" target="_blank" class="mt-3 inline-flex items-center space-x-1 py-1 px-2 bg-primary/10 rounded-md border border-primary/30 text-primary theme-transition active:scale-95 transition-all">
                                <span class="text-[9px] font-bold uppercase tracking-widest">${t.map}</span>
                                <span class="text-[9px]">ğŸ“</span>
                            </a>
                        ` : '';

                        items.push(`
                            <div class="bg-white p-5 rounded-3xl border border-gray-300 shadow-sm flex space-x-4 items-start fade-in">
                                <div class="w-10 h-10 rounded-xl ${colors[category]} flex items-center justify-center text-lg flex-shrink-0">
                                    ${icons[category]}
                                </div>
                                <div class="flex-grow">
                                    <div class="flex justify-between items-center mb-1">
                                        <p class="text-[10px] font-bold text-primary theme-transition uppercase">${currentLang === 'en' ? day.day : day.dayZh} ${day.display} â€¢ ${currentLang === 'en' ? day.city : day.cityZh}</p>
                                        <span class="text-[10px] font-bold text-secondary opacity-60">${e.time}</span>
                                    </div>
                                    <h4 class="font-bold text-sm leading-tight">${currentLang === 'en' ? e.title : e.titleZh}</h4>
                                    <p class="text-[11px] text-secondary mt-1">${e.details}</p>
                                    <div class="flex flex-wrap items-center gap-2">
                                        ${e.sub ? `<p class="text-[10px] text-primary theme-transition mt-1 font-bold">${e.sub}</p>` : ''}
                                        ${mapBtn}
                                    </div>
                                </div>
                            </div>
                        `);
                    }
                });
            });
            container.innerHTML = items.length ? items.join('') : `<p class="text-center text-secondary text-xs p-8 italic">No items found.</p>`;
        }

        const timeline = document.getElementById('view-timeline');
        timeline.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; touchStartY = e.changedTouches[0].screenY; }, false);
        timeline.addEventListener('touchend', e => { touchEndX = e.changedTouches[0].screenX; touchEndY = e.changedTouches[0].screenY; handleSwipe(); }, false);

        function handleSwipe() {
            if (currentTab !== 'timeline') return;
            const xDiff = touchEndX - touchStartX;
            const yDiff = touchEndY - touchStartY;
            if (Math.abs(xDiff) > Math.abs(yDiff) && Math.abs(xDiff) > 50) {
                if (xDiff < 0) { if (currentDayIndex < tripData.length - 1) showDay(currentDayIndex + 1); }
                else { if (currentDayIndex > 0) showDay(currentDayIndex - 1); }
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            updateUIStrings();
            renderDateSelector();
        });
    </script>
</body>
</html>
